openapi: 3.0.0
info:
  title: API de Gestão de Documentos - Secretaria
  description: API completa com Autenticação, Gestão de Usuários e Documentos.
  version: 1.6.0
servers:
  - url: http://localhost:3000/api
    description: Servidor Local
tags:
  - nome: Autenticação
  - nome: Usuários
  - nome: Documentos

paths:
  /login:
    post:
      summary: Realiza o login do usuário
      tags: [Autenticação]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, senha]
              properties:
                email: { type: string, example: "admin@secretaria.com" }
                senha: { type: string, example: "123456" }
      responses:
        200: { description: Login realizado com sucesso }

  /refresh-token:
    post:
      summary: Atualiza o token de acesso
      tags: [Autenticação]
      responses:
        200: { description: Token atualizado }

  /users:
    get:
      summary: Lista todos os usuários cadastrados
      tags: [Usuários]
      responses:
        200: { description: Lista de usuários retornada }
    post:
      summary: Cria um novo usuário (Aluno ou Secretária)
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nome, email, senha]
              properties:
                nome: { type: string }
                email: { type: string }
                senha: { type: string }
      responses:
        201: { description: Usuário criado com sucesso }

  /users/{id}:
    put:
      summary: Edita os dados de um usuário existente
      tags: [Usuários]
      parameters:
        - in: path
          nome: id
          required: true
          schema: { type: string }
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nome: { type: string }
                email: { type: string }
      responses:
        200: { description: Usuário atualizado }
    delete:
      summary: Remove um usuário do sistema
      tags: [Usuários]
      parameters:
        - in: path
          nome: id
          required: true
          schema: { type: string }
      responses:
        204: { description: Usuário deletado }

  /documentos/upload:
    post:
      summary: Upload obrigatório do pacote de documentos (CPF, RG, Comprovante, Histórico)
      tags: [Documentos]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [userId, cpf, rg, comprovante, historico]
              properties:
                userId: { type: string, description: "ID do usuário dono dos documentos" }
                cpf: { type: string, format: binary }
                rg: { type: string, format: binary }
                comprovante: { type: string, format: binary }
                historico: { type: string, format: binary }
      responses:
        201: { description: Upload realizado com sucesso }

  /documentos:
    get:
      summary: Lista documentos com filtros de busca (Secretaria)
      tags: [Documentos]
      parameters:
        - in: query
          nome: userId
          schema: { type: string }
          description: Buscar documentos de um usuário específico
        - in: query
          nome: status
          schema: { type: string, enum: [PENDENTE, APROVADO, REJEITADO] }
      responses:
        200: { description: Lista de documentos retornada }