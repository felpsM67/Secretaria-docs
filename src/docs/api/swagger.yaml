# openapi: 3.0.0
# info:
#   title: API de Gestão de Documentos - Secretaria
#   description: API para upload obrigatório de pacote de documentos e gestão de status.
#   version: 1.1.0
# servers:
#   - url: http://localhost:3000/api
#     description: Servidor Local
# paths:
#   /documentos/upload:
#     post:
#       summary: Realiza o upload obrigatório de todos os documentos do aluno
#       tags:
#         - Documentos
#       requestBody:
#         required: true
#         content:
#           multipart/form-data:
#             schema:
#               type: object
#               required:
#                 - userId
#                 - cpf
#                 - rg
#                 - comprovante
#                 - historico
#               properties:
#                 userId:
#                   type: string
#                   description: ID do usuário dono dos documentos
#                 cpf:
#                   type: string
#                   format: binary
#                   description: Arquivo do CPF
#                 rg:
#                   type: string
#                   format: binary
#                   description: Arquivo do RG
#                 comprovante:
#                   type: string
#                   format: binary
#                   description: Arquivo do Comprovante de Residência
#                 historico:
#                   type: string
#                   format: binary
#                   description: Arquivo do Histórico Escolar
#       responses:
#         '201':
#           description: Pacote de documentos enviado com sucesso
#         '400':
#           description: Erro na requisição (arquivos ausentes)
#         '500':
#           description: Erro interno do servidor

#   /documentos:
#     get:
#       summary: Lista todos os documentos ou filtra por usuário
#       tags:
#         - Documentos
#       parameters:
#         - name: userId
#           in: query
#           required: false
#           schema:
#             type: string
#           description: ID do usuário para filtrar
#       responses:
#         '200':
#           description: Lista de documentos retornada com sucesso. Inclui a URL para visualização.
#         '500':
#           description: Erro interno do servidor
    
openapi: 3.0.0
info:
  title: API de Gestão de Documentos - Secretaria
  description: API completa com Autenticação, Gestão de Usuários e Documentos.
  version: 1.6.0
servers:
  - url: http://localhost:3000/api
    description: Servidor Local
tags:
  - name: Autenticação
  - name: Usuários
  - name: Documentos

paths:
  /login:
    post:
      summary: Realiza o login do usuário
      tags: [Autenticação]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email: { type: string, example: "admin@secretaria.com" }
                password: { type: string, example: "123456" }
      responses:
        200: { description: Login realizado com sucesso }

  /refresh-token:
    post:
      summary: Atualiza o token de acesso
      tags: [Autenticação]
      responses:
        200: { description: Token atualizado }

  /users:
    get:
      summary: Lista todos os usuários cadastrados
      tags: [Usuários]
      responses:
        200: { description: Lista de usuários retornada }
    post:
      summary: Cria um novo usuário (Aluno ou Secretária)
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password]
              properties:
                name: { type: string }
                email: { type: string }
                password: { type: string }
      responses:
        201: { description: Usuário criado com sucesso }

  /users/{id}:
    put:
      summary: Edita os dados de um usuário existente
      tags: [Usuários]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                email: { type: string }
      responses:
        200: { description: Usuário atualizado }
    delete:
      summary: Remove um usuário do sistema
      tags: [Usuários]
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        204: { description: Usuário deletado }

  /documentos/upload:
    post:
      summary: Upload obrigatório do pacote de documentos (CPF, RG, Comprovante, Histórico)
      tags: [Documentos]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [userId, cpf, rg, comprovante, historico]
              properties:
                userId: { type: string, description: "ID do usuário dono dos documentos" }
                cpf: { type: string, format: binary }
                rg: { type: string, format: binary }
                comprovante: { type: string, format: binary }
                historico: { type: string, format: binary }
      responses:
        201: { description: Upload realizado com sucesso }

  /documentos:
    get:
      summary: Lista documentos com filtros de busca (Secretaria)
      tags: [Documentos]
      parameters:
        - in: query
          name: userId
          schema: { type: string }
          description: Buscar documentos de um usuário específico
        - in: query
          name: status
          schema: { type: string, enum: [PENDENTE, VALIDADO, REJEITADO] }
      responses:
        200: { description: Lista de documentos retornada }